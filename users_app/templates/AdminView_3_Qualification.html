
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BayaniHire Admin Center</title>
</head>
<body>
    <!-- Logo -->
    <div>
        <img src="{% static 'Logo.png' %}" alt="BayaniHire Logo" width="200" height="200">
    </div>

    <!-- Buttons -->
    <div>
        <button onclick="window.location.href='{% url 'list_of_applicants' %}';">List of Applicants</button>
        <button onclick="window.location.href='{% url 'list_of_jobs' %}';">List of Jobs</button>
        <button onclick="window.location.href='{% url 'qualification' %}';">Qualification</button>
        <button onclick="window.location.href='{% url 'schedule' %}';">Schedule</button>
        <button onclick="window.location.href='{% url 'feedback' %}';">Feedback</button>
    </div>

    <!-- Title and Profile -->
    <div>
        <h1>BayaniHire Admin Center</h1>
        <button onclick="window.location.href='{% url 'adminprofile' %}';">Profile</button>
    </div>
    <h2>List of Qualified Applicants</h2>
    
    <form method="POST" action="{% url 'send_schedule' %}" id="interviewer-form">
        {% csrf_token %}
        <table width="100%">
            <tr>
                <!-- Interviewers List -->
                <td valign="top" width="50%">
                    <p>Here is the list of available Interviewers. Kindly select an Interviewer.</p>
                    <table border="1" width="100%" id="interviewer-table">
                        {% for interviewer in interviewers %}
                            <tr>
                                <td>
                                    <input type="radio" name="selected_interviewer" value="{{ interviewer.interviewer_id }}" 
                                        onclick="selectInterviewer({{ interviewer.schedule_dates|safe }}, '{{ interviewer.interviewer_name }}');" required>
                                    {{ interviewer.interviewer_name }}
                                </td>
                            </tr>
                        {% endfor %}
                    </table>
                </td>

                <!-- Schedule Dates List -->
                <td valign="top" width="50%">
                    <p>Available Schedule Dates</p>
                    <table border="1" width="100%" id="schedule-table">
                        <tbody id="schedule-dates-list">
                            <!-- Schedule dates will be dynamically populated here -->
                        </tbody>
                    </table>
                </td>
            </tr>
        </table>

        <script>
            function selectInterviewer(scheduleDates, interviewerName) {
                document.getElementById("interviewer-name-input").value = interviewerName; // Set hidden input value for interviewer name
                const scheduleTable = document.getElementById("schedule-dates-list");
                scheduleTable.innerHTML = ""; // Clear previous dates

                if (scheduleDates.length > 0) {
                    scheduleDates.forEach(date => {
                        let row = document.createElement("tr");
                        let cell = document.createElement("td");
                        let radioButton = document.createElement("input");

                        radioButton.type = "radio";
                        radioButton.name = "selected_schedule_date";
                        radioButton.value = date;
                        radioButton.required = true;

                        cell.appendChild(radioButton);
                        cell.appendChild(document.createTextNode(" " + date));
                        row.appendChild(cell);
                        scheduleTable.appendChild(row);
                    });
                } else {
                    let row = document.createElement("tr");
                    let cell = document.createElement("td");
                    cell.textContent = "No available schedule dates";
                    row.appendChild(cell);
                    scheduleTable.appendChild(row);
                }
            }
        </script>
        <input type="hidden" id="interviewer-name-input" name="interviewer_name">
        <!-- Applicants and Jobs Table with Control Buttons -->
        <table width="100%">
            <tr>
                <td valign="top" width="75%">
                    <p>Here is the list of available Interviewees. Kindly select an Interviewee.</p>
                    
                    <table border="1" width="100%">
                        <tr>
                            <th>Qualified for Interview</th>
                            <th>Job Applied</th>
                        </tr>
                        
                        {% for applicant in applicants %}
                        <tr>
                            <td>
                                {{ applicant.full_name }}
                                <!-- Hidden inputs to pass data -->
                                <input type="hidden" name="applicant_name" value="{{ applicant.full_name }}">
                                <input type="hidden" name="job_details" value="{{ applicant.job_title }} at {{ applicant.job_company }}">
                            </td>
                            <td>{{ applicant.job_title }} at {{ applicant.job_company }}</td>
                        </tr>
                        {% endfor %}
                    </table>
                </td>
                <!-- Control Buttons -->
                <td valign="top" width="25%">
                    <br><br><br>
                    <button type="submit">Send</button><br><br>
                    <button type="button" onclick="window.location.href='{% url 'open_schedule_list' %}';">Open Schedule List</button>
                </td>
            </tr>
        </table>
    </form>
    

</body>
</html>
